/*!
 * Excolo Slider - A simple jquery slider
 *
 * Examples and documentation at:
 * http://excolo.github.io/Excolo-Slider/
 *
 * Author: Nikolaj Dam Larsen
 * Version: 0.2.1 (07-JUNE-2013)
 *
 * Released under the MIT license
 * https://github.com/Excolo/ExcoloSlider/blob/master/MIT-License.txt
 */
;(function(f,d,a,g){var b,e,c;b="0.2.1";e="excoloSlider";c=(function(){function h(j,i){this.elem=j;this.$elem=f(j);this.options=i;this.metadata=this.$elem.data("plugin-options")}return h})();c.prototype={defaults:{width:800,height:530,autoSize:true,keyboardNav:true,touchNav:true,mouseNav:true,startSlide:1,autoPlay:true,delay:0,interval:3000,repeat:true,playReverse:false,hoverPause:true,animationCssTransitions:true,animationDuration:500,animationTimingFunction:"linear",activeSlideClass:"es-active"},init:function(){var i,h;i=this;i.config=f.extend({},i.defaults,i.options,i.metadata);i.data=f.data(i);f.data(i,"currentSlide",i.config.playReverse&&i.config.startSlide==1?i.$elem.children().length-1:i.config.startSlide-1);f.data(i,"nextSlide",i.data.currentSlide);f.data(i,"totalslides",i.$elem.children().length);f.data(i,"browserEnginePrefix",i._getBrowserEnginePrefix());f.data(i,"isPlaying",false);f.data(i,"isAnimating",false);f.data(i,"playPaused",false);f.data(i,"justTouched",false);f.data(i,"isMoving",false);f.data(i,"width",i.config.width);if(typeof TouchEvent!=="undefined"){f.data(this,"touchEnabled",true)}i.$elem.css({position:"relative"});i.$elem.wrapInner("<div class='slide-wrapper'>",i.$elem).children();i.$elem.wrapInner("<div class='slide-container'>",f(".slide-wrapper",i.$elem)).children();f(".slide-wrapper",i.$elem).children().addClass("slide").css({position:"absolute",top:0,left:0,width:i.data.width,height:i.config.height,zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});h=f(".slide-wrapper",i.$elem).children().height();f(".slide-wrapper",i.$elem).css({position:"relative",left:0,height:h});f(".slide-container",i.$elem).css({width:i.data.width,overflow:"hidden",height:h});if(i.config.touchNav&&i.data.touchEnabled){f(".slide-wrapper",i.$elem).on("touchstart",function(k){var j=k.originalEvent.touches[0];i._onMoveStart(j.pageX,j.pageY);return k.stopPropagation()});f(".slide-wrapper",i.$elem).on("touchmove",function(k){var j=k.originalEvent.touches[0];k.preventDefault();i._onMove(j.pageX,j.pageY);return k.stopPropagation()});f(".slide-wrapper",i.$elem).on("touchend",function(j){i._onMoveEnd();return j.stopPropagation()})}if(i.config.mouseNav){f(".slide-wrapper",i.$elem).css("cursor","pointer");f(".slide-wrapper",i.$elem).on("dragstart",function(j){return false});f(".slide-wrapper",i.$elem).on("mousedown",function(j){i._onMoveStart(j.clientX,j.clientY);return j.stopPropagation()});f(d).on("mousemove",function(j){j.preventDefault();i._onMove(j.clientX,j.clientY);return j.stopPropagation()});f(d).on("mouseup",function(j){i._onMoveEnd();return j.stopPropagation()})}if(i.config.keyboardNav){f(d).keydown(function(j){return i._onKeyboardNav(j)})}if(i.config.autoSize){setTimeout(function(){i._resize()},50);f(d).resize(function(){return setTimeout(function(){i._resize()},50)})}i._prepareslides();i.gotoSlide(i.data.currentSlide);if(i.config.autoPlay){setTimeout(function(){i.start()},i.config.delay)}return this},previous:function(){var h,i;h=this;f.data(h,"slideDirection","previous");i=(h.data.nextSlide-1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide-1)<0){if(h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide-1)>0){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},next:function(){var h,i;h=this;f.data(h,"slideDirection","next");i=(h.data.nextSlide+1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide+1)>(h.data.totalslides-1)){if(!h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide+1)<(h.data.totalslides-1)){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},start:function(){var i,h,j;i=this;h=f(".slide-container",i.$elem);if(i.data.isPlaying&&i.data.playTimer){clearInterval(i.data.playTimer)}j=setInterval((function(){if(i.config.playReverse){i.previous()}else{i.next()}}),i.config.interval);f.data(i,"playTimer",j);if(i.config.hoverPause){h.unbind();h.bind("mouseenter",function(){f.data(i,"playPaused",true);return i.stop()});h.bind("mouseleave",function(){f.data(i,"playPaused",false);return i.start()})}f.data(i,"isPlaying",true)},stop:function(){var i,h;i=this;h=f(".slide-container",i.$elem);clearInterval(i.data.playTimer);f.data(i,"playTimer",null);if(i.config.hoverPause&&!i.data.playPaused){h.unbind()}f.data(i,"isPlaying",false)},gotoSlide:function(m){var j,i,n,l,k,h;j=this;f.data(j,"nextSlide",(m)%j.data.totalslides);i=(m)%j.data.totalslides;f.data(j,"currentSlide",i);n=f(".slide-wrapper",j.$elem);l=n.children();k=n.children(":eq("+i+")");h=k.position().left;l.removeClass(j.config.activeSlideClass);k.addClass(j.config.activeSlideClass);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-h),0)}else{n.position().left=-h}j._alignSlides(h)},_manualInterference:function(){var h=this;if(h.data.isPlaying){h.stop();h.start()}},_prepareslides:function(){var l,n,m,j,k,h;l=this;n=f(".slide-wrapper",l.$elem);m=n.children();j=l.data.width;k=Math.floor(l.data.totalslides/2);h=0;m.each(function(){f(this).css({display:"block",left:j*h,zIndex:10});h++;if(l.config.repeat&&h>k){h=l.data.totalslides%2?-k:-(k-1)}})},_onKeyboardNav:function(j){var i,h;i=this;h=j.which;switch(h){case 37:i.previous();i._manualInterference();break;case 39:i.next();i._manualInterference();break}j.preventDefault()},_onMoveStart:function(h,j){var i=this;f.data(i,"touchTime",Number(new Date()));f.data(i,"touchedX",h);f.data(i,"touchedY",j);f.data(i,"isMoving",true);if(i.data.isPlaying){f.data(i,"playPaused",true);i.stop()}},_onMove:function(o,n){var h,p,l,k,m,i,j;h=this;if(!h.data.isMoving){return}p=f(".slide-wrapper",h.$elem);f.data(h,"scrolling",Math.abs(o-h.data.touchedX)<Math.abs(n-h.data.touchedY));if(!h.data.scrolling&&!h.data.isAnimating){l=p.children(":eq("+h.data.nextSlide+")");k=l.position().left;m=h.data.browserEnginePrefix.css;i=o-h.data.touchedX;j=h.data.width*0.1;if(!h.config.repeat){if(h.data.currentSlide<=0&&-i<-j){i=j}else{if(h.data.currentSlide>=(h.data.totalslides-1)&&-i>j){i=-j}}}h._transition(-k+i,0)}},_onMoveEnd:function(){var l,n,m,i,k,h,j;l=this;n=f(".slide-wrapper",l.$elem);f.data(l,"justTouched",true);m=n.children(":eq("+l.data.nextSlide+")");i=m.position().left;k=l.data.width*0.5;h=l.data.width*0.1;j=(Number(new Date())-l.data.touchTime<250);if(!l.config.repeat&&(n.position().left<-(i)&&l.data.currentSlide>=(l.data.totalslides-1)||n.position().left>(-i)&&l.data.currentSlide<=0)){l._transition((-i),0.15)}else{if(n.position().left>(-i+k)||(n.position().left>(-i+h)&&j)){this.previous()}else{if(n.position().left<-(i+k)||(n.position().left<-(i+h)&&j)){this.next()}else{l._transition((-i),0.15)}}}l._alignSlides(i);f.data(l,"isMoving",false);if(l.data.playPaused){l.start()}},_alignSlides:function(r){var j,s,q,o,t,k,h,l,n,m,p;j=this;if(!j.config.repeat){return}s=f(".slide-wrapper",j.$elem);q=s.children();if(r===g){o=s.children(":eq("+j.data.nextSlide+")");r=o.position().left}r=Math.round(r,0);t=Math.ceil(j.data.totalslides/2);k=j.data.width;h=0;q.each(function(){var i=f(this).position().left;if(i>r-k){h++}});l=t-h;if(l<0){l=j.data.totalslides%2==0?l+1:l}for(n=0;n<Math.abs(l);n++){m=[].reduce.call(q,function(i,u){return f(i).offset().left<f(u).offset().left?i:u});p=[].reduce.call(q,function(i,u){return f(i).offset().left>f(u).offset().left?i:u});if(l>0){f(m).css("left",Math.round(f(p).position().left+k))}else{f(p).css("left",Math.round(f(m).position().left-k))}}},_slide:function(){var j,l,h,r,q,o,n,m,i,p,k;j=this;l=j.data.nextSlide;h=j.data.currentSlide;r=f(".slide-wrapper",j.$elem);q=r.children();o=r.children(":eq("+l+")");n=r.children(":eq("+h+")");m=j.config.activeSlideClass;i=j.data.width;p=Math.round(n.position().left);k=Math.round(o.position().left);q.removeClass(m);o.addClass(m);j._alignSlides(k);f.data(j,"isAnimating",true);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-k),(j.data.justTouched?0.5:1));r.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){f.data(j,"currentSlide",l);f.data(j,"isAnimating",false);f.data(j,"justTouched",false);r.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})}else{r.stop().animate({left:-k},j.config.animationDuration,function(){f.data(j,"currentSlide",l);f.data(j,"isAnimating",false);f.data(j,"justTouched",false)})}},_transition:function(i,k){var m,o,l,h,n,j;m=this;o=f(".slide-wrapper",m.$elem);if(k===g||k<0){k=1}l=m.data.browserEnginePrefix.css;h=l+"Transform";n=l+"TransitionDuration";j=l+"TransitionTimingFunction";o[0].style[h]="translateX("+i+"px)";o[0].style[n]=(m.config.animationDuration*k)+"ms";o[0].style[j]=m.config.animationTimingFunction},_resize:function(){var l,h,j,i,k;l=this;if(l.data.isPlaying){f.data(l,"playPaused",true);l.stop()}h=l.$elem.width();j=l.config.height/l.config.width;i=h*j;f.data(l,"width",h);f(".slide",l.$elem).css({width:h,height:i});k=f(".slide-wrapper",l.$elem).children().height();f(".slide-wrapper",l.$elem).css({height:k});f(".slide-container",l.$elem).css({width:h,height:k});if(l.data.playPaused){f.data(l,"playPaused",false);l.start()}l._prepareslides();l.gotoSlide(l.data.currentSlide)},_getBrowserEnginePrefix:function(){var j,k,h;j="Transition";k=["Moz","Webkit","Khtml","O","ms"];h=0;while(h<k.length){if(typeof a.body.style[k[h]+j]==="string"){return{css:k[h]}}h++}return false}};c.defaults=c.prototype.defaults;f.fn.excoloSlider=function(h){return this.each(function(){new c(this,h).init()})}})(jQuery,window,document);